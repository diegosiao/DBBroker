<div align="center">
  <img src="/assets/logo-with-name.png" alt="DBBroker logo" />
  <br/>
  A lightweight and simple to use .NET tool and library to make manipulating database records effortless.
</div>

## Philosophy

First of all, there is no such thing as a silver bullet that kills all kinds of monsters in the world. 

With that said, every kind of application can benefit from DBBroker features, from the simpler to the complex ones intended for restrict scenarios with, for example, the following requirements:

- Applications should **NOT** bear the responsibility nor privilege to execute [DDL](https://en.wikipedia.org/wiki/Data_definition_language).

- Applications' Data Access Objects should reflect databases as clients not the opposite.

- [Schema Migrations](https://en.wikipedia.org/wiki/Schema_migration) cannot be used because of a development process lead by [Database Administrators](https://en.wikipedia.org/wiki/Database_administration).

These are common requirements for applications in many organizations where solutions are database centered, like the one where this tool was developed initially.

## Quick Start

On your terminal navigate to the `*.csproj` directory of your application, then follow the steps bellow.

**Step 1:** Install `DBBroker.Cli` .NET tool globally.

```bash
dotnet install DBBroker.Cli -g
```

**Step 2:** Add `DBBroker` package to your project.

```bash
dotnet nuget add DBBroker
```

**Step 3:** Create a `dbbroker.config.json` file at the root of your project.

```bash
dotnet dbbroker init --namespace="EShop.DataModels" --connection-string "[your-connection-string]" --provider Oracle
```

**Step 4:** Synchronize your project with your database. That command will generate the Data Models.

```bash
dotnet dbbroker sync
```

## Examples

Entity persistence.

```C#
// Data Models classes are generated by DBBroker
var customer = new CustomersDataModel();
customer.Name = "John Three Sixteen";
customer.Birthday = new DateTime(1980, 3, 16);

var id = await _dbBroker.InsertAsync(customer);
```

Entity persistence with transactions.

```C#
using var connection = new SqlConnection();
connection.Open();
var transaction = connection.GetTransaction();

try 
{
    var customer = new CustomersDataModel();
    customer.Id = Guid.NewGuid();
    customer.Name = "John Three Sixteen";
    customer.Birthday = new DateTime(1980, 3, 16);

    await connection.InsertAsync(customer, transaction);

    var car = new CarEdm();
    car.Model = "Renault Twingo";
    car.Year = 2001;
    car.CustomerId = customer.Id;

    await connection.InsertAsync(car, transaction);
    transaction.Commit();
}
catch(Exception ex)
{
    transaction.Rollback();
}
```

Retrieving a record.

```C#
var customer = await connection.GetByKey<CustomersDataModel>("543491fa-788a-474c-9f3b-6ed6566e5d2c");
```

Retrieving multiple and filtered records.

```C#
var inactiveCustomers = await connection.Select<CustomersDataModel>()
  .AddFilter(x => x.StatusId, SqlEquals.To(3))
  .FetchFirst(records: 100, skip: 300) // help implementing a 'load more' strategy
  .ExecuteAsync();
```

```C#
// another example with columns
```

```C#
// another example with columns and order by
```
